# Vue 3 + Piniaë¥¼ ì´ìš©í•œ ìƒíƒœ ê´€ë¦¬

## ğŸ§  1. Piniaë€?

- Vue ê³µì‹ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.
- Vuexì˜ í›„ì† ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ë” ê°€ë³ê³  ì‚¬ìš©í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.
- `Composition API` ìŠ¤íƒ€ì¼ê³¼ í›Œë¥­í•˜ê²Œ í˜¸í™˜ë©ë‹ˆë‹¤.

---

## ğŸ”§ 2. ì„¤ì¹˜ ë° ì„¤ì •

```bash
npm install pinia
```

### ğŸ“¦ main.js ë“±ë¡

```js
import { createApp } from 'vue';
import { createPinia } from 'pinia';
import App from './App.vue';

const app = createApp(App);
app.use(createPinia());
app.mount('#app');
```

---

## ğŸª 3. ìŠ¤í† ì–´ ìƒì„± (Composition API ë°©ì‹)

```js
// stores/counter.js
import { defineStore } from 'pinia';
import { ref, computed } from 'vue';

export const useCounterStore = defineStore('counter', () => {
  // state
  const count = ref(0);
  
  // getters
  const doubleCount = computed(() => count.value * 2);
  
  // actions
  function increment() {
    count.value++;
  }
  
  function decrement() {
    count.value--;
  }
  
  return {
    count,
    doubleCount,
    increment,
    decrement
  };
});
```

> `defineStore`ë¥¼ ì‚¬ìš©í•˜ì—¬ state, actions, gettersë¥¼ Composition API ìŠ¤íƒ€ì¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

---

## ğŸ§© 4. ìŠ¤í† ì–´ ì‚¬ìš©

```vue
<script setup>
import { useCounterStore } from '@/stores/counter';
import { storeToRefs } from 'pinia';

const counter = useCounterStore();
// ë°˜ì‘ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ storeToRefs ì‚¬ìš©
const { count, doubleCount } = storeToRefs(counter);
</script>

<template>
  <p>Count: {{ count }}</p>
  <p>Double Count: {{ doubleCount }}</p>
  <button @click="counter.increment">+</button>
  <button @click="counter.decrement">-</button>
</template>
```

---

## ğŸ“¦ 5. ë¹„ë™ê¸° ì•¡ì…˜ ì‚¬ìš©

```js
// stores/user.js
import { defineStore } from 'pinia';
import { ref } from 'vue';

export const useUserStore = defineStore('user', () => {
  const user = ref(null);
  const loading = ref(false);
  const error = ref(null);

  async function fetchUser(id) {
    loading.value = true;
    try {
      const response = await fetch(`/api/users/${id}`);
      user.value = await response.json();
    } catch (e) {
      error.value = e.message;
    } finally {
      loading.value = false;
    }
  }

  return {
    user,
    loading,
    error,
    fetchUser
  };
});
```

---

## ğŸ” 6. ìƒíƒœ ì˜ì†í™” (Persisted State)

- í”ŒëŸ¬ê·¸ì¸ì„ ì´ìš©í•´ ìƒíƒœë¥¼ localStorageì— ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
npm install pinia-plugin-persistedstate
```

```js
// main.js
import piniaPluginPersistedstate from 'pinia-plugin-persistedstate';
pinia.use(piniaPluginPersistedstate);
```

```js
// stores/counter.js
export const useCounterStore = defineStore('counter', () => {
  const count = ref(0);
  
  function increment() {
    count.value++;
  }
  
  return {
    count,
    increment
  };
}, {
  persist: true // ìƒíƒœ ì˜ì†í™” í™œì„±í™”
});
```

---

## ğŸ¯ 7. ìŠ¤í† ì–´ ê°„ ìƒí˜¸ì‘ìš©

```js
// stores/cart.js
import { defineStore } from 'pinia';
import { ref, computed } from 'vue';
import { useUserStore } from './user';

export const useCartStore = defineStore('cart', () => {
  const userStore = useUserStore();
  const items = ref([]);
  
  const totalItems = computed(() => items.value.length);
  
  function addItem(item) {
    if (userStore.isLoggedIn) {
      items.value.push(item);
    }
  }
  
  return {
    items,
    totalItems,
    addItem
  };
});
```

---

## ğŸ’¡ 8. ì£¼ìš” íŒ

1. `storeToRefs`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°˜ì‘ì„± ìœ ì§€
- Pinia ìŠ¤í† ì–´ì˜ ìƒíƒœë¥¼ êµ¬ì¡° ë¶„í•´ í• ë‹¹(destructuring)í•  ë•Œ ë°˜ì‘ì„±ì„ ìƒì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤
```js
 // âŒ ì˜ëª»ëœ ë°©ë²•
   const { count } = counter; // ë°˜ì‘ì„± ìƒì‹¤
```
- ë°˜ì‘ì„± ìœ ì§€
  - Pinia ìŠ¤í† ì–´ì˜ ìƒíƒœë¥¼ êµ¬ì¡° ë¶„í•´ í• ë‹¹í•˜ë©´ì„œë„ ë°˜ì‘ì„±ì„ ìœ ì§€í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤
  - refë‚˜ computedë¡œ ì •ì˜ëœ ìƒíƒœë“¤ë§Œ ë³€í™˜í•©ë‹ˆë‹¤
  - ë©”ì„œë“œ(actions)ëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤
```js
const { count } = storeToRefs(counter); // ë°˜ì‘ì„± ìœ ì§€
const { increment } = counter; // ë©”ì„œë“œëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©
```

2. ìŠ¤í† ì–´ ì´ˆê¸°í™”
```js
const counter = useCounterStore();
counter.$reset(); // ìŠ¤í† ì–´ ì´ˆê¸°í™”
```

3. ìŠ¤í† ì–´ êµ¬ë…
```js
counter.$subscribe((mutation, state) => {
  console.log('ìƒíƒœ ë³€ê²½:', mutation.type, state);
});
```

---

## âœ… ì •ë¦¬

- PiniaëŠ” Vue 3 ê³µì‹ ìƒíƒœ ê´€ë¦¬ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.
- Composition API ìŠ¤íƒ€ì¼ë¡œ ìƒíƒœë¥¼ ì‰½ê³  ëª…í™•í•˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `storeToRefs`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°˜ì‘ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.
- ë¹„ë™ê¸° ì•¡ì…˜ê³¼ ìŠ¤í† ì–´ ê°„ ìƒí˜¸ì‘ìš©ì„ ì§€ì›í•©ë‹ˆë‹¤.

